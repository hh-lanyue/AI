# LSTM

## 一 步骤

### 1 预处理

#### 1.1 分词、分字

![image-20231102172055498](./assets/image-20231102172055498.png)

#### 1.2 语料表/字符表

![image-20231102172119705](./assets/image-20231102172119705.png)

![image-20231102172127239](./assets/image-20231102172127239.png)

#### 1.3 将词映射成一个向量(word-vector)-embedding

![image-20231102172355787](./assets/image-20231102172355787.png)

![image-20231102172402178](./assets/image-20231102172402178.png)

> 举例子
>
> batch = 64
>
> 语句长度 = 30
>
> 字向量维度 = 300

 

### 2 网络结构

![image-20231102211017465](./assets/image-20231102211017465.png)

![image-20231102210527092](./assets/image-20231102210527092.png)

![image-20231102211121127](./assets/image-20231102211121127.png)

![image-20231102200030789](./assets/image-20231102200030789.png)

![image-20231102200007589](./assets/image-20231102200007589.png)

> 注意：
>
> 用 RNN 训练时，语句长度必须固定，因为网络结构是固定的，因此对训练的语句采取==多割少补==的策略
>
> ![image-20231102203125563](./assets/image-20231102203125563.png)



### 3 训练、测试

#### 3.1 将字对应语料表得到ID

![image-20231102203800130](./assets/image-20231102203800130.png)

#### 3.2 embeding 操作，将每个字转变为 300 维的向量

![image-20231102205652628](./assets/image-20231102205652628.png)

![image-20231102205722530](./assets/image-20231102205722530.png)